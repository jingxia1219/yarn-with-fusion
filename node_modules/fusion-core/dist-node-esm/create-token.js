/** Copyright (c) 2018 Uber Technologies, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 * 
 */
import { captureStackTrace } from './stack-trace.js';
export const TokenType = Object.freeze({
  Required: 0,
  Optional: 1
});

function Ref() {}

export class TokenImpl {
  constructor(name, ref) {
    this.name = name;
    this.ref = ref || new Ref();
    this.type = ref ? TokenType.Optional : TokenType.Required;
    this.stacks = [{
      type: 'token',
      stack: captureStackTrace(createToken)
    }];

    if (!ref) {
      this.optional = new TokenImpl(name, this.ref);
    }
  }

}
export function createToken(name) {
  return new TokenImpl(name);
}
export function getTokenRef(token) {
  if (token instanceof TokenImpl) {
    return token.ref;
  }

  return token;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9jcmVhdGUtdG9rZW4uanMiXSwibmFtZXMiOlsiY2FwdHVyZVN0YWNrVHJhY2UiLCJUb2tlblR5cGUiLCJPYmplY3QiLCJmcmVlemUiLCJSZXF1aXJlZCIsIk9wdGlvbmFsIiwiUmVmIiwiVG9rZW5JbXBsIiwiY29uc3RydWN0b3IiLCJuYW1lIiwicmVmIiwidHlwZSIsInN0YWNrcyIsInN0YWNrIiwiY3JlYXRlVG9rZW4iLCJvcHRpb25hbCIsImdldFRva2VuUmVmIiwidG9rZW4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUEsU0FBUUEsaUJBQVIsUUFBZ0Msa0JBQWhDO0FBRUEsT0FBTyxNQUFNQyxTQUFTLEdBQUdDLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjO0FBQ3JDQyxFQUFBQSxRQUFRLEVBQUUsQ0FEMkI7QUFFckNDLEVBQUFBLFFBQVEsRUFBRTtBQUYyQixDQUFkLENBQWxCOztBQUlQLFNBQVNDLEdBQVQsR0FBZSxDQUFFOztBQUNqQixPQUFPLE1BQU1DLFNBQU4sQ0FBZ0I7QUFDckJDLEVBQUFBLFdBQVcsQ0FBQ0MsSUFBRCxFQUFPQyxHQUFQLEVBQVk7QUFDckIsU0FBS0QsSUFBTCxHQUFZQSxJQUFaO0FBQ0EsU0FBS0MsR0FBTCxHQUFXQSxHQUFHLElBQUksSUFBSUosR0FBSixFQUFsQjtBQUNBLFNBQUtLLElBQUwsR0FBWUQsR0FBRyxHQUFHVCxTQUFTLENBQUNJLFFBQWIsR0FBd0JKLFNBQVMsQ0FBQ0csUUFBakQ7QUFDQSxTQUFLUSxNQUFMLEdBQWMsQ0FBQztBQUFDRCxNQUFBQSxJQUFJLEVBQUUsT0FBUDtBQUFnQkUsTUFBQUEsS0FBSyxFQUFFYixpQkFBaUIsQ0FBQ2MsV0FBRDtBQUF4QyxLQUFELENBQWQ7O0FBQ0EsUUFBSSxDQUFDSixHQUFMLEVBQVU7QUFDUixXQUFLSyxRQUFMLEdBQWdCLElBQUlSLFNBQUosQ0FBY0UsSUFBZCxFQUFvQixLQUFLQyxHQUF6QixDQUFoQjtBQUNEO0FBQ0Y7O0FBVG9CO0FBWXZCLE9BQU8sU0FBU0ksV0FBVCxDQUFxQkwsSUFBckIsRUFBMkI7QUFDaEMsU0FBTyxJQUFJRixTQUFKLENBQWNFLElBQWQsQ0FBUDtBQUNEO0FBRUQsT0FBTyxTQUFTTyxXQUFULENBQXFCQyxLQUFyQixFQUE0QjtBQUNqQyxNQUFJQSxLQUFLLFlBQVlWLFNBQXJCLEVBQWdDO0FBQzlCLFdBQU9VLEtBQUssQ0FBQ1AsR0FBYjtBQUNEOztBQUNELFNBQU9PLEtBQVA7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbIi8qKiBDb3B5cmlnaHQgKGMpIDIwMTggVWJlciBUZWNobm9sb2dpZXMsIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAbm9mbG93XG4gKi9cblxuaW1wb3J0IHtjYXB0dXJlU3RhY2tUcmFjZX0gZnJvbSAnLi9zdGFjay10cmFjZS5qcyc7XG5cbmV4cG9ydCBjb25zdCBUb2tlblR5cGUgPSBPYmplY3QuZnJlZXplKHtcbiAgUmVxdWlyZWQ6IDAsXG4gIE9wdGlvbmFsOiAxLFxufSk7XG5mdW5jdGlvbiBSZWYoKSB7fVxuZXhwb3J0IGNsYXNzIFRva2VuSW1wbCB7XG4gIGNvbnN0cnVjdG9yKG5hbWUsIHJlZikge1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy5yZWYgPSByZWYgfHwgbmV3IFJlZigpO1xuICAgIHRoaXMudHlwZSA9IHJlZiA/IFRva2VuVHlwZS5PcHRpb25hbCA6IFRva2VuVHlwZS5SZXF1aXJlZDtcbiAgICB0aGlzLnN0YWNrcyA9IFt7dHlwZTogJ3Rva2VuJywgc3RhY2s6IGNhcHR1cmVTdGFja1RyYWNlKGNyZWF0ZVRva2VuKX1dO1xuICAgIGlmICghcmVmKSB7XG4gICAgICB0aGlzLm9wdGlvbmFsID0gbmV3IFRva2VuSW1wbChuYW1lLCB0aGlzLnJlZik7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUb2tlbihuYW1lKSB7XG4gIHJldHVybiBuZXcgVG9rZW5JbXBsKG5hbWUpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VG9rZW5SZWYodG9rZW4pIHtcbiAgaWYgKHRva2VuIGluc3RhbmNlb2YgVG9rZW5JbXBsKSB7XG4gICAgcmV0dXJuIHRva2VuLnJlZjtcbiAgfVxuICByZXR1cm4gdG9rZW47XG59XG4iXX0=