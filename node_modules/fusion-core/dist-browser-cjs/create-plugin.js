"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createPlugin = createPlugin;
exports.declarePlugin = declarePlugin;
exports.getPluginFn = getPluginFn;

var _stackTrace = require("./stack-trace.js");

var _legacyCompat = require("./legacy-compat.js");

/** Copyright (c) 2018 Uber Technologies, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 * 
 */
function createPlugin(opts) {
  // Inject the legacy plugin properties for compatibiity purposes.
  // However, we should eventually get rid of these properties and possibly
  // instead just represent plugins as plain generator functions.
  return { ...opts,
    __plugin__: true,
    __fn__: (0, _legacyCompat.createPlugin)(opts),
    stack: (0, _stackTrace.captureStackTrace)(createPlugin)
  };
}

function declarePlugin(fn) {
  fn.__fplugin__ = true;
  return fn;
}

function getPluginFn(val) {
  if (val && val.__plugin__ && val.__fn__) {
    return val.__fn__;
  }

  if (val && val.__fplugin__) {
    return val;
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9jcmVhdGUtcGx1Z2luLmpzIl0sIm5hbWVzIjpbImNyZWF0ZVBsdWdpbiIsIm9wdHMiLCJfX3BsdWdpbl9fIiwiX19mbl9fIiwic3RhY2siLCJkZWNsYXJlUGx1Z2luIiwiZm4iLCJfX2ZwbHVnaW5fXyIsImdldFBsdWdpbkZuIiwidmFsIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFRQTs7QUFFQTs7QUFWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1PLFNBQVNBLFlBQVQsQ0FBc0JDLElBQXRCLEVBQTRCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBLFNBQU8sRUFDTCxHQUFHQSxJQURFO0FBRUxDLElBQUFBLFVBQVUsRUFBRSxJQUZQO0FBR0xDLElBQUFBLE1BQU0sRUFBRSxnQ0FBbUJGLElBQW5CLENBSEg7QUFJTEcsSUFBQUEsS0FBSyxFQUFFLG1DQUFrQkosWUFBbEI7QUFKRixHQUFQO0FBTUQ7O0FBRU0sU0FBU0ssYUFBVCxDQUF1QkMsRUFBdkIsRUFBMkI7QUFDaENBLEVBQUFBLEVBQUUsQ0FBQ0MsV0FBSCxHQUFpQixJQUFqQjtBQUNBLFNBQU9ELEVBQVA7QUFDRDs7QUFFTSxTQUFTRSxXQUFULENBQXFCQyxHQUFyQixFQUEwQjtBQUMvQixNQUFJQSxHQUFHLElBQUlBLEdBQUcsQ0FBQ1AsVUFBWCxJQUF5Qk8sR0FBRyxDQUFDTixNQUFqQyxFQUF5QztBQUN2QyxXQUFPTSxHQUFHLENBQUNOLE1BQVg7QUFDRDs7QUFDRCxNQUFJTSxHQUFHLElBQUlBLEdBQUcsQ0FBQ0YsV0FBZixFQUE0QjtBQUMxQixXQUFPRSxHQUFQO0FBQ0Q7QUFDRiIsInNvdXJjZXNDb250ZW50IjpbIi8qKiBDb3B5cmlnaHQgKGMpIDIwMTggVWJlciBUZWNobm9sb2dpZXMsIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAbm9mbG93XG4gKi9cblxuaW1wb3J0IHtjYXB0dXJlU3RhY2tUcmFjZX0gZnJvbSAnLi9zdGFjay10cmFjZS5qcyc7XG5cbmltcG9ydCB7Y3JlYXRlUGx1Z2luIGFzIGNvbXBhdENyZWF0ZVBsdWdpbn0gZnJvbSAnLi9sZWdhY3ktY29tcGF0LmpzJztcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBsdWdpbihvcHRzKSB7XG4gIC8vIEluamVjdCB0aGUgbGVnYWN5IHBsdWdpbiBwcm9wZXJ0aWVzIGZvciBjb21wYXRpYmlpdHkgcHVycG9zZXMuXG4gIC8vIEhvd2V2ZXIsIHdlIHNob3VsZCBldmVudHVhbGx5IGdldCByaWQgb2YgdGhlc2UgcHJvcGVydGllcyBhbmQgcG9zc2libHlcbiAgLy8gaW5zdGVhZCBqdXN0IHJlcHJlc2VudCBwbHVnaW5zIGFzIHBsYWluIGdlbmVyYXRvciBmdW5jdGlvbnMuXG4gIHJldHVybiB7XG4gICAgLi4ub3B0cyxcbiAgICBfX3BsdWdpbl9fOiB0cnVlLFxuICAgIF9fZm5fXzogY29tcGF0Q3JlYXRlUGx1Z2luKG9wdHMpLFxuICAgIHN0YWNrOiBjYXB0dXJlU3RhY2tUcmFjZShjcmVhdGVQbHVnaW4pLFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVjbGFyZVBsdWdpbihmbikge1xuICBmbi5fX2ZwbHVnaW5fXyA9IHRydWU7XG4gIHJldHVybiBmbjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFBsdWdpbkZuKHZhbCkge1xuICBpZiAodmFsICYmIHZhbC5fX3BsdWdpbl9fICYmIHZhbC5fX2ZuX18pIHtcbiAgICByZXR1cm4gdmFsLl9fZm5fXztcbiAgfVxuICBpZiAodmFsICYmIHZhbC5fX2ZwbHVnaW5fXykge1xuICAgIHJldHVybiB2YWw7XG4gIH1cbn1cbiJdfQ==