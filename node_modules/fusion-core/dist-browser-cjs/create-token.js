"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createToken = createToken;
exports.getTokenRef = getTokenRef;
exports.TokenImpl = exports.TokenType = void 0;

var _stackTrace = require("./stack-trace.js");

/** Copyright (c) 2018 Uber Technologies, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 * 
 */
const TokenType = Object.freeze({
  Required: 0,
  Optional: 1
});
exports.TokenType = TokenType;

function Ref() {}

class TokenImpl {
  constructor(name, ref) {
    this.name = name;
    this.ref = ref || new Ref();
    this.type = ref ? TokenType.Optional : TokenType.Required;
    this.stacks = [{
      type: 'token',
      stack: (0, _stackTrace.captureStackTrace)(createToken)
    }];

    if (!ref) {
      this.optional = new TokenImpl(name, this.ref);
    }
  }

}

exports.TokenImpl = TokenImpl;

function createToken(name) {
  return new TokenImpl(name);
}

function getTokenRef(token) {
  if (token instanceof TokenImpl) {
    return token.ref;
  }

  return token;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9jcmVhdGUtdG9rZW4uanMiXSwibmFtZXMiOlsiVG9rZW5UeXBlIiwiT2JqZWN0IiwiZnJlZXplIiwiUmVxdWlyZWQiLCJPcHRpb25hbCIsIlJlZiIsIlRva2VuSW1wbCIsImNvbnN0cnVjdG9yIiwibmFtZSIsInJlZiIsInR5cGUiLCJzdGFja3MiLCJzdGFjayIsImNyZWF0ZVRva2VuIiwib3B0aW9uYWwiLCJnZXRUb2tlblJlZiIsInRva2VuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFRQTs7QUFSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlPLE1BQU1BLFNBQVMsR0FBR0MsTUFBTSxDQUFDQyxNQUFQLENBQWM7QUFDckNDLEVBQUFBLFFBQVEsRUFBRSxDQUQyQjtBQUVyQ0MsRUFBQUEsUUFBUSxFQUFFO0FBRjJCLENBQWQsQ0FBbEI7OztBQUlQLFNBQVNDLEdBQVQsR0FBZSxDQUFFOztBQUNWLE1BQU1DLFNBQU4sQ0FBZ0I7QUFDckJDLEVBQUFBLFdBQVcsQ0FBQ0MsSUFBRCxFQUFPQyxHQUFQLEVBQVk7QUFDckIsU0FBS0QsSUFBTCxHQUFZQSxJQUFaO0FBQ0EsU0FBS0MsR0FBTCxHQUFXQSxHQUFHLElBQUksSUFBSUosR0FBSixFQUFsQjtBQUNBLFNBQUtLLElBQUwsR0FBWUQsR0FBRyxHQUFHVCxTQUFTLENBQUNJLFFBQWIsR0FBd0JKLFNBQVMsQ0FBQ0csUUFBakQ7QUFDQSxTQUFLUSxNQUFMLEdBQWMsQ0FBQztBQUFDRCxNQUFBQSxJQUFJLEVBQUUsT0FBUDtBQUFnQkUsTUFBQUEsS0FBSyxFQUFFLG1DQUFrQkMsV0FBbEI7QUFBdkIsS0FBRCxDQUFkOztBQUNBLFFBQUksQ0FBQ0osR0FBTCxFQUFVO0FBQ1IsV0FBS0ssUUFBTCxHQUFnQixJQUFJUixTQUFKLENBQWNFLElBQWQsRUFBb0IsS0FBS0MsR0FBekIsQ0FBaEI7QUFDRDtBQUNGOztBQVRvQjs7OztBQVloQixTQUFTSSxXQUFULENBQXFCTCxJQUFyQixFQUEyQjtBQUNoQyxTQUFPLElBQUlGLFNBQUosQ0FBY0UsSUFBZCxDQUFQO0FBQ0Q7O0FBRU0sU0FBU08sV0FBVCxDQUFxQkMsS0FBckIsRUFBNEI7QUFDakMsTUFBSUEsS0FBSyxZQUFZVixTQUFyQixFQUFnQztBQUM5QixXQUFPVSxLQUFLLENBQUNQLEdBQWI7QUFDRDs7QUFDRCxTQUFPTyxLQUFQO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyIvKiogQ29weXJpZ2h0IChjKSAyMDE4IFViZXIgVGVjaG5vbG9naWVzLCBJbmMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQG5vZmxvd1xuICovXG5cbmltcG9ydCB7Y2FwdHVyZVN0YWNrVHJhY2V9IGZyb20gJy4vc3RhY2stdHJhY2UuanMnO1xuXG5leHBvcnQgY29uc3QgVG9rZW5UeXBlID0gT2JqZWN0LmZyZWV6ZSh7XG4gIFJlcXVpcmVkOiAwLFxuICBPcHRpb25hbDogMSxcbn0pO1xuZnVuY3Rpb24gUmVmKCkge31cbmV4cG9ydCBjbGFzcyBUb2tlbkltcGwge1xuICBjb25zdHJ1Y3RvcihuYW1lLCByZWYpIHtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMucmVmID0gcmVmIHx8IG5ldyBSZWYoKTtcbiAgICB0aGlzLnR5cGUgPSByZWYgPyBUb2tlblR5cGUuT3B0aW9uYWwgOiBUb2tlblR5cGUuUmVxdWlyZWQ7XG4gICAgdGhpcy5zdGFja3MgPSBbe3R5cGU6ICd0b2tlbicsIHN0YWNrOiBjYXB0dXJlU3RhY2tUcmFjZShjcmVhdGVUb2tlbil9XTtcbiAgICBpZiAoIXJlZikge1xuICAgICAgdGhpcy5vcHRpb25hbCA9IG5ldyBUb2tlbkltcGwobmFtZSwgdGhpcy5yZWYpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVG9rZW4obmFtZSkge1xuICByZXR1cm4gbmV3IFRva2VuSW1wbChuYW1lKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRva2VuUmVmKHRva2VuKSB7XG4gIGlmICh0b2tlbiBpbnN0YW5jZW9mIFRva2VuSW1wbCkge1xuICAgIHJldHVybiB0b2tlbi5yZWY7XG4gIH1cbiAgcmV0dXJuIHRva2VuO1xufVxuIl19